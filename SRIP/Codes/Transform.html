<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>2D Transforms</title>
<link rel="stylesheet" href="demo.css">

<style>
	#transforms {
	   width: 250px;
	   height: 200px;
	   overflow: auto;
	   margin: 0;
	   padding: 4px;
	   background-color: white;
	   border: thin solid #740b0b;
	}

	  #box {
	   width: 250px;
	   height: 200px;
	   overflow: auto;
	   margin: 0;
	   padding: 4px;
	   background-color: white;
	   border: thin solid #740b0b;
	  

	}
	#World {
	   width: 300px;
	   height: 400px;
	   overflow: auto;
	   margin: 0;
	   padding: 4px;
	   background-color: white;
	   border: thin solid #740b0b;
	   

	}
	#Display {
	   width: 300px;
	   height: 400px;
	   overflow: auto;
	   margin: 0;
	   padding: 4px;
	   background-color: white;
	   border: thin solid #740b0b;
	   

	}

	#transforms p {
	    margin: 0px;
	    padding: 1px;
	}
	#tools p {
	    margin: 2px;
	    padding: 0px;
	    text-indent: 0px;
	}
	#transforms p.selected {
	    background-color: #DDDDFF;
	}
	.input {
	    margin-top:5px;
	    margin-right:4px;
	    padding: 2px;
	    background-color: white;
	    border: thin solid black;
	    font-size:80%;
	    float: left;
	}
</style>
<script src="demo-core.js"></script>



<script type="text/javascript">

var canvas;
var graphics;
var shape = 0;
var transforms = [];
var transformParagraphs = [];
var transformContainer;
var selectedTransform = -1;
var animating = false;
var animationStep;
var showResultOnly = false;

var colors = ["black", "#AA0000", "#00AA00", "#0000AA", "#00AAAA", "#AA00AA", "#AAAA00", "#885500", "#AAAAAA"];

function draw() {
    var i,j;
    graphics.clearRect(0,0,400,400);
    graphics.strokeStyle = "black";

    graphics.save();
    graphics.translate(200.5,200.5);
    graphics.scale(40,-40);
    graphics.beginPath();
    graphics.moveTo(-5,0);
    graphics.lineTo(5,0);
    graphics.moveTo(0,5);
    graphics.lineTo(0,-5);
    graphics.restore();
    graphics.lineWidth = 2;
    graphics.stroke();

    graphics.save();
    graphics.translate(200.5,200.5);
    graphics.scale(40,-40);
    graphics.beginPath();
    for (i = -4; i <= 4; i++) {
        graphics.moveTo(-5,i);
        graphics.lineTo(5,i);
        graphics.moveTo(i,-5);
        graphics.lineTo(i,5);
    }
    graphics.restore();
    graphics.lineWidth = 1;
    graphics.stroke();

    graphics.fillStyle = "#8080FF";
    for (i = -5; i <= 5; i++) {
        if (i != 0) {
            graphics.fillText(String(i), 40*(i+5)+2, 198);
            graphics.fillText(String(i), 202, 400 - 40*(i+5)-2);
        }
    }
    
    graphics.save();
    
    graphics.translate(200.5,200.5);
    graphics.scale(40,-40);
    if (!showResultOnly || animating) {
        graphics.save();
        drawShape(0);
        graphics.restore();
    }
    
    if (showResultOnly) {
        for (j = transforms.length-1; j >= 0; j--) {
           applyTransform(transforms[j]);
        }
        drawShape(transforms.length);
    }
    else {
        var top = animating? animationStep : transforms.length;
        for (i = 0; i < top; i++) {
            graphics.save();
            for (j = i; j >= 0; j--) {
               applyTransform(transforms[j]);
            }
            drawShape(i+1);
            graphics.restore();
        }
    }
    
    graphics.restore();
    
}

var errorTimeout = null;
function setErrorMessage(message) {
    if (errorTimeout) {
        clearTimeout(errorTimeout);
        errorTimeout = null;
    }
    var s = message || "Modeling Transforms in 2D";
    document.getElementById("headline").innerHTML = s;
    document.getElementById("headline").style.color = message? "red" : "black";
    if (message) {
        errorTimeout = setTimeout(function() { setErrorMessage() }, 5000);        
    }
}

function clearTransforms() {
    setErrorMessage();
    stopAnimation();
    transforms = [];
    transformParagraphs = [];
    selectedTransform = -1;
    document.getElementById("transforms").innerHTML = "";
    draw();
    document.getElementById("rotBut").disabled = false;
    document.getElementById("transBut").disabled = false;
    document.getElementById("scaleBut").disabled = false;
    document.getElementById("deleteButton").disabled = true;
    document.getElementById("upButton").disabled = true;
    document.getElementById("downButton").disabled = true;
    document.getElementById("animateCheckbox").disabled = true;
}

function deleteLast() {
    setErrorMessage();
    if (transforms.length == 0) {
        return;
    }
    if (transforms.length == 1) {
        stopAnimation();
    }
    transforms.pop();
    var p = transformParagraphs.pop();
    document.getElementById("transforms").removeChild(p);
    if (selectedTransform >= transforms.length) {
        selectedTransform = -1;
        document.getElementById("upButton").disabled = true;
        document.getElementById("downButton").disabled = true;
    }
    document.getElementById("rotBut").disabled = false;
    document.getElementById("transBut").disabled = false;
    document.getElementById("scaleBut").disabled = false;
    document.getElementById("deleteButton").disabled = (transforms.length == 0);
    document.getElementById("animateCheckbox").disabled = (transforms.length == 0);
    draw();
}

function moveTransformUp() {
    setErrorMessage();
    if (selectedTransform <= 0) {
        return;
    }
    var p = transformParagraphs[selectedTransform];
    transformParagraphs[selectedTransform] = transformParagraphs[selectedTransform-1];
    transformParagraphs[selectedTransform-1] = p;
    var t = transforms[selectedTransform];
    transforms[selectedTransform] = transforms[selectedTransform-1];
    transforms[selectedTransform - 1] = t;
    selectedTransform -= 1;
    document.getElementById("upButton").disabled = (selectedTransform == 0);
    document.getElementById("downButton").disabled = (selectedTransform == transforms.length-1);
    var tr = document.getElementById("transforms");
    if (selectedTransform == 0) {
        tr.removeChild(p);
        tr.insertBefore(p,tr.firstElementChild);
    }
    else {
        var prev = p.previousElementSibling;
        tr.removeChild(p);
        tr.insertBefore(p,prev);
    }
    transformParagraphs[selectedTransform].style.color = colors[selectedTransform+1];
    transformParagraphs[selectedTransform+1].style.color = colors[selectedTransform+2];
    transformParagraphs[selectedTransform].numberInList = selectedTransform;
    transformParagraphs[selectedTransform+1].numberInList = selectedTransform+1;
    draw();
}

function moveTransformDown() {
    setErrorMessage();
    if (selectedTransform >= transforms.length - 1) {
        return;
    }
    var p = transformParagraphs[selectedTransform];
    transformParagraphs[selectedTransform] = transformParagraphs[selectedTransform+1];
    transformParagraphs[selectedTransform+1] = p;
    var t = transforms[selectedTransform];
    transforms[selectedTransform] = transforms[selectedTransform+1];
    transforms[selectedTransform + 1] = t;
    selectedTransform += 1;
    document.getElementById("upButton").disabled = (selectedTransform == 0);
    document.getElementById("downButton").disabled = (selectedTransform == transforms.length-1);
    var tr = document.getElementById("transforms");
    if (selectedTransform == transforms.length - 1) {
        tr.removeChild(p);
        tr.appendChild(p);
    }
    else {
        var next = p.nextElementSibling.nextElementSibling;
        tr.removeChild(p);
        tr.insertBefore(p,next);
    }
    transformParagraphs[selectedTransform-1].style.color = colors[selectedTransform];
    transformParagraphs[selectedTransform].style.color = colors[selectedTransform+1];
    transformParagraphs[selectedTransform-1].numberInList = selectedTransform-1;
    transformParagraphs[selectedTransform].numberInList = selectedTransform;
    draw();
}




function init() {
    canvas = document.getElementById("maincanvas");
    if (!maincanvas.getContext) {
        document.getElementById("headline").innerHTML = "ERROR: Canvas not supported";
        return;
    }
    graphics = canvas.getContext('2d');
    graphics.font = "10pt monospace";
    transformContainer = document.getElementById("transforms");
    
    draw();
}

</script>


</head>
<body onload="init()">
<script src="2d-demo.js"></script>
	<div id="content" >

		<h3 id="headline">Modeling Transforms in 2D</h3>

		<div id="canvas-holder">  <!-- It is for the left most output box -->
			<canvas id="maincanvas" width="400" height="446">
				<!-- This is the Inside main canvas -->
			</canvas>
		</div>

		<div id="tools">
			<div > 
				<button class="tablinks" onclick="openTab(event,'World')" autofocus >World</button>
				<button class="tablinks" onclick="openTab(event,'Display')">Display</button> 
			</div> 

				<!-- Tab content -->

			
			  
			<div id="Display" class="tabcontent">
			  
			</div>

			<div id="World" class="tabcontent">

				
					<div style="width:300px; height:200px; " >
						 <iframe src = "1.html" style="width:280px; height:190px">
		         			Sorry your browser does not support inline frames.
		     			 </iframe>

					</div>
			
			<!--
			<div id="transforms"width="150" height="200">
				
			</div>
			-->
			
					<div id="box" style="width:300px; height:200px">
						<div id="transforms" style="width:270px; height:100px">
							<li>World
								<option>Instance 1</option>
							</li>
						</div>



						<p><button>New</button>
							<button>Edit</button></p>

						<p><button id="upButton" onclick="moveTransformUp()">Move Up</button>
						   <button id="downButton" onclick="moveTransformDown()">Move Down</button></p>
						<p><button onclick="clearTransforms()">Clear</button>
						   <button onclick="deleteLast()" id="deleteButton">Delete Last</button></p>
						<p style="margin-top:10px">Shape: <select id="shapeSelect" onChange="changeShape()">
						   <option value="0">Letter F</option>
						   <option value="1">Centered F</option>
						   <option value="2">Square</option>
						   <option value="3">Rectangle</option>
						   <option value="4">Step</option>
						   <option value="5">"Hello!"</option>
						</select></p>
						<p style="margin-top:5px"><label><input type="checkbox" id="animateCheckbox" onchange="doAnimateCB()">Animate</label></p>
						<p style="margin-top:5px"><label><input type="checkbox" id="resultOnlyCB" onchange="doResultOnly()">Show Result Only</label></p>
					</div>
			</div>
		</div>

		<div class="input" style="clear:both">
			Rotate&nbsp;<input type="text" size="3" id="deg"><button id="rotBut" onclick="addRotate()">Add</button>
			</div>
			<div class="input">
			Translate&nbsp;<input type="text" size="3" id="tx">,<input itype="text" size="3" id="ty"><button id="transBut" onclick="addTranslate()"">Add</button>
			</div>
			<div class="input">
			Scale&nbsp;<input type="text" size="3" id="sx">,<input type="text" size="3" id="sy"> <button id="scaleBut" onclick="addScale()">Add</button>
		</div>

	 </div>



	<div id="help-content" style="display:none">
	<h3>About this demo...</h3>
	<p>The demo shows an original object as a gray shape near the center of the
	coordinate grid on the left.  On the right, there is a list of transforms.
	The results of transforming the original shape are shown as colored shapes
	on the coordinate grid.  The red shape is the result of transforming the
	original shape by the <b>first</b> transform in the list.  The green shape is
	the result of applying the second transform to the red shape; that is,
	it is the result of applying <b>the first two</b> transforms to the original
	shape.  The blue shape is the result of applying the <b>first three</b> transforms
	to the original shape. Note that the transforms accumulate!  If you find
	the colors hard to follow, turn on the "Animate" option.  You will see a
	looping animation in which the shapes are added to the picture in the order in which
	they are created.</p>
	<p>One of the transforms in the list can be "selected." The selected transform
	has a light blue background.  You can select a transform by clicking it.
	Use the "Move up" and "Move down" buttons to move the selected transform
	up or down in the list.  This will change the order in which the transforms
	are applied, and so will change the sequence of shapes that is generated.</p>
	<p>The tree small input panels on the bottom can be used to add transforms
	to the list.  To add  a rotation, enter the number of <b>degrees</b>,
	and click the "Add" button that is next to the input box.  For translation
	and scale, enter two numbers, and click the corresponding "Add" button.
	Be careful! The coordinate grid only shows coordinates in the range -5
	to 5, so it's easy to get a shape that lies outside the visible grid.
	The demo doesn't stop you from doing that.</p>
	<p>You might start by moving transforms around in the original list.
	Make sure that you understand how the shapes are produced.  Then
	clear the list and make up your own transform.  Try comparing
	rotate-then-translate to translate-then-rotate.  Try rotating
	the object about a point other than the origin.  Try some negative
	scale factors. Try arranging eight objects in a circle around
	the origin.  (There is a limit of eight transforms.)  Try
	to make a shear transformation from rotations and scalings.
	(Hint: Start with a 45-degree rotation, followed by a
	non-uniform scaling.)</p>
	<p>Note by the way that transforms are applied to the object in
	the order that they occur in the list.  Remember that if you
	want to achieve the same effect in your code, you would have
	to specify the transforms in the oppiosit order, and you
	would have to do that before drawing the object.</p>
	</div>



<!-- support for help text -- do not change. -->

<!--
<div id="help-icon">
<img src="./image/question32.png" onclick="showDemoHelp()"
    title="Click here for information about this demo." width="32" height="32">
</div>
<div id="hide-help-icon">
<img src="./image/close32.png" onclick="showDemoHelp()"
    title="Click here to return to the demo." width="65" height="32">
</div>
<div id="helpBG" style="display:none"></div>   -->
</body>
</html>
